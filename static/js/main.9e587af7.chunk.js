(this["webpackJsonpreact-blog"]=this["webpackJsonpreact-blog"]||[]).push([[0],{50:function(t,n,e){"use strict";e.r(n);var r=e(1),c=e(0),i=e(16),o=e.n(i),a=e(5),u=e(2),s=e(3),j=e(20),b=e.n(j),d=e(27),l="token",f=function(t){localStorage.setItem(l,t)},O=function(){return localStorage.getItem(l)},h="https://student-json-api.lidemy.me",p=function(){var t=Object(d.a)(b.a.mark((function t(n){var e,r,c,i;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(n);case 2:return e=t.sent,r=e.headers,t.next=6,e.json();case 6:return c=t.sent,i=(i=r.get("link").replace(/\</gi,"").replace(/\>/gi,"").split(",")).map((function(t){return t.replace(/http/,"https").replace(/ /,"").split(";")})),t.abrupt("return",{links:i,posts:c});case 10:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),x=function(){var t=O();return fetch("".concat(h,"/me"),{headers:{authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()}))},v=Object(c.createContext)(null),g=e(6);function m(){var t=Object(u.a)(["\n  text-align: center;\n  margin-top: 5rem;\n"]);return m=function(){return t},t}function w(){var t=Object(u.a)(["\n  color: red;\n"]);return w=function(){return t},t}var y=s.a.div(w()),S=s.a.form(m());function k(){var t=Object(c.useContext)(v).setUser,n=Object(c.useState)(""),e=Object(a.a)(n,2),i=e[0],o=e[1],u=Object(c.useState)(""),s=Object(a.a)(u,2),j=s[0],b=s[1],d=Object(c.useState)(""),l=Object(a.a)(d,2),O=l[0],p=l[1],m=Object(g.f)();return Object(r.jsxs)(S,{onSubmit:function(n){n.preventDefault(),p(null),function(t,n){return fetch("".concat(h,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n})}).then((function(t){return t.json()}))}(i,j).then((function(n){if(0===n.ok)return p(n.message);f(n.token),x().then((function(n){if(1!==n.ok)return f(null),p(n.toString());t(n.data),m.push("/")}))}))},children:[Object(r.jsxs)("div",{children:["username:"," ",Object(r.jsx)("input",{value:i,onChange:function(t){return o(t.target.value)}})]}),Object(r.jsxs)("div",{children:["password:"," ",Object(r.jsx)("input",{value:j,onChange:function(t){return b(t.target.value)},type:"password"})]}),Object(r.jsx)("button",{children:"\u767b\u5165"}),O&&Object(r.jsx)(y,{children:O})]})}var C=e(10);function L(){var t=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return L=function(){return t},t}function P(){var t=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return P=function(){return t},t}function E(){var t=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return E=function(){return t},t}function _(){var t=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return _=function(){return t},t}var z=s.a.div(_()),D=s.a.div(E()),I=Object(s.a)(C.b)(P()),$=s.a.div(L());function A(t){var n=t.post;return Object(r.jsxs)(D,{children:[Object(r.jsx)(I,{to:"/posts/".concat(n.id),children:n.title}),Object(r.jsx)($,{children:new Date(n.createdAt).toLocaleString()})]})}function R(){var t=Object(c.useState)([]),n=Object(a.a)(t,2),e=n[0],i=n[1];return Object(c.useEffect)((function(){fetch("".concat(h,"/posts?_sort=createdAt&_order=desc")).then((function(t){return t.json()})).then((function(t){return i(t)}))}),[]),Object(r.jsx)(z,{children:e.map((function(t){return Object(r.jsx)(A,{post:t},t.id)}))})}function J(){var t=Object(u.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"]);return J=function(){return t},t}function N(){var t=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  ","\n"]);return N=function(){return t},t}function T(){var t=Object(u.a)(["\n  display: flex;\n  align-items: center;\n  height: 64px;\n"]);return T=function(){return t},t}function U(){var t=Object(u.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]);return U=function(){return t},t}function B(){var t=Object(u.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n  box-sizing: border-box;\n  background-color: #fff;\n"]);return B=function(){return t},t}var M=s.a.div(B()),q=s.a.div(U()),F=s.a.div(T()),G=Object(s.a)(C.b)(N(),(function(t){return t.$active&&"\n    background: rgba(0,0,0,0.1);\n  "})),H=s.a.div(J(),F);function K(){var t=Object(g.g)(),n=Object(c.useContext)(v),e=n.user,i=n.setUser,o=n.isLoading,a=Object(g.f)();return Object(r.jsxs)(M,{children:[Object(r.jsxs)(H,{children:[Object(r.jsx)(q,{children:"\u90e8\u843d\u683c"}),Object(r.jsxs)(F,{children:[Object(r.jsx)(G,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),Object(r.jsx)(G,{to:"/about",$active:"/about"===t.pathname,children:"\u95dc\u65bc\u90e8\u843d\u683c"}),Object(r.jsx)(G,{to:"/postsList",$active:"/postsList"===t.pathname,children:"\u6587\u7ae0\u5217\u8868"}),e&&Object(r.jsx)(G,{$active:"/new-post"===t.pathname,to:"/new-post",children:"\u767c\u5e03\u6587\u7ae0"})]})]}),o?null:Object(r.jsxs)(F,{children:[!e&&Object(r.jsx)(G,{$active:"/login"===t.pathname,to:"/login",children:"\u767b\u5165"}),!e&&Object(r.jsx)(G,{$active:"/register"===t.pathname,to:"/register",children:"\u8a3b\u518a"}),e&&Object(r.jsx)(G,{onClick:function(){f(""),i(null),"/"!==t.pathname&&a.push("/")},children:"\u767b\u51fa"})]})]})}var Q=e(17),V=Object(Q.b)({name:"posts",initialState:{isLoadingPost:!1,post:null,newPostResponse:null},reducers:{setIsLoadingPost:function(t,n){t.isLoadingPost=n.payload},setPost:function(t,n){t.post=n.payload},setNewPostResponse:function(t,n){t.newPostResponse=n.payload}}}),W=V.actions,X=W.setIsLoadingPost,Y=W.setPost,Z=W.setNewPostResponse,tt=function(t){return function(n){n(X(!0)),function(t){return fetch("".concat(h,"/posts/").concat(t)).then((function(t){return t.json()}))}(t).then((function(t){n(Y(t)),n(X(!1))})).catch((function(t){return console.log(t)}))}},nt=function(t,n){return function(e){(function(t,n){var e=O();return fetch("".concat(h,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(e),"content-type":"application/json"},body:JSON.stringify({title:t,body:n})}).then((function(t){return t.json()}))})(t,n).then((function(t){e(Z(t))}))}},et=V.reducer,rt=e(13);function ct(){var t=Object(u.a)(["\n  max-width: 600px;\n  width: 100%;\n  text-align: center;\n  padding: 10px;\n"]);return ct=function(){return t},t}function it(){var t=Object(u.a)(["\n  display: flex;\n  justify-content: center;\n  max-width: 600px;\n  width: 100%;\n  flex-direction: column;\n  align-items: center;\n  padding: 10px;\n"]);return it=function(){return t},t}function ot(){var t=Object(u.a)(["\n  white-space: pre-line;\n  line-height: 2;\n  text-align: left;\n"]);return ot=function(){return t},t}function at(){var t=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return at=function(){return t},t}function ut(){var t=Object(u.a)(["\n  font-size: 30px;\n  color: #333;\n  text-decoration: none;\n  margin-bottom: 10px;\n  font-weight: bold;\n"]);return ut=function(){return t},t}function st(){var t=Object(u.a)(["\n  border-bottom: px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return st=function(){return t},t}function jt(){var t=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return jt=function(){return t},t}var bt=s.a.div(jt()),dt=s.a.div(st()),lt=s.a.div(ut()),ft=s.a.div(at()),Ot=s.a.div(ot()),ht=s.a.div(it()),pt=s.a.div(ct());function xt(){var t=Object(g.f)(),n=Object(g.h)().id,e=Object(rt.b)(),i=Object(rt.c)((function(t){return t.posts.isLoadingPost})),o=Object(rt.c)((function(t){return t.posts.post}));Object(c.useEffect)((function(){e(tt(n))}),[n,e]);return Object(r.jsx)(bt,{children:!i&&o&&o.id?Object(r.jsxs)(dt,{children:[Object(r.jsx)("button",{onClick:function(){(function(t){return fetch("".concat(h,"/posts/").concat(t),{method:"DELETE"}).then((function(t){return t.json()}))})(n).then((function(){t.push("/")}))},children:"\u522a\u9664"}),Object(r.jsxs)(ht,{children:[Object(r.jsx)(lt,{children:o.title}),Object(r.jsx)(ft,{children:new Date(o.createdAt).toLocaleString()})]}),Object(r.jsx)(pt,{children:Object(r.jsx)(Ot,{children:o.body})})]}):null})}function vt(){var t=Object(u.a)(["\n  text-align: center;\n  margin-top: 5rem;\n"]);return vt=function(){return t},t}function gt(){var t=Object(u.a)(["\n  color: red;\n"]);return gt=function(){return t},t}var mt=s.a.div(gt()),wt=s.a.form(vt());function yt(){var t=Object(c.useState)(""),n=Object(a.a)(t,2),e=n[0],i=n[1],o=Object(c.useState)(""),u=Object(a.a)(o,2),s=u[0],j=u[1],b=Object(c.useState)(""),d=Object(a.a)(b,2),l=d[0],f=d[1],O=Object(g.f)(),h=Object(rt.b)(),p=Object(rt.c)((function(t){return t.posts.newPostResponse}));return Object(c.useEffect)((function(){return p&&0===p.ok&&f(p.message),i(""),j(""),p&&p.id&&O.push("/posts/"+p.id),function(){h(Z(null))}}),[p,O,h]),Object(r.jsxs)(wt,{onSubmit:function(t){t.preventDefault(),h(nt(e,s))},children:[Object(r.jsxs)("div",{children:["title:",Object(r.jsx)("input",{value:e,onChange:function(t){return i(t.target.value)}})]}),Object(r.jsxs)("div",{children:["body:",Object(r.jsx)("textarea",{cols:"50",rows:"20",value:s,onChange:function(t){return j(t.target.value)}})]}),Object(r.jsx)("button",{children:"\u767c\u5e03"}),l&&Object(r.jsx)(mt,{children:l})]})}function St(){var t=Object(u.a)(["\n  max-width: 600px;\n  line-height: 1.5;\n"]);return St=function(){return t},t}function kt(){var t=Object(u.a)([""]);return kt=function(){return t},t}function Ct(){var t=Object(u.a)(["\n  width: 80%;\n  display: flex;\n  margin: 0 auto;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]);return Ct=function(){return t},t}var Lt=s.a.div(Ct()),Pt=s.a.h1(kt()),Et=s.a.h3(St());function _t(){return Object(r.jsxs)(Lt,{children:[Object(r.jsx)(Pt,{children:"\u95dc\u65bc\u90e8\u843d\u683c\u7684\u4e8c\u4e09\u4e8b"}),Object(r.jsx)(Et,{children:"\u9019\u662f Mentor program \u7a0b\u5f0f\u5c0e\u5e2b\u8a08\u756b\u7b2c4\u671f\u7b2c22\u9031\u7684\u4f5c\u696d \u9019\u9031\u6211\u5011\u7528 React \u5c07\u8ab2\u7a0b\u88e1\u505a\u5230\u4e00\u534a\u7684\u90e8\u843d\u683c\u529f\u80fd\u88dc\u5b8c\u3002"})]})}function zt(){var t=Object(u.a)([""]);return zt=function(){return t},t}function Dt(){var t=Object(u.a)(["\n  margin-top: 2rem;\n"]);return Dt=function(){return t},t}function It(){var t=Object(u.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return It=function(){return t},t}function $t(){var t=Object(u.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return $t=function(){return t},t}function At(){var t=Object(u.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return At=function(){return t},t}function Rt(){var t=Object(u.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return Rt=function(){return t},t}var Jt=s.a.div(Rt()),Nt=s.a.div(At()),Tt=Object(s.a)(C.b)($t()),Ut=s.a.div(It()),Bt=s.a.button(Dt()),Mt=s.a.h1(zt());function qt(t){var n=t.post;return Object(r.jsxs)(Nt,{children:[Object(r.jsx)(Tt,{to:"/posts/".concat(n.id),children:n.title}),Object(r.jsx)(Ut,{children:new Date(n.createdAt).toLocaleString()})]})}function Ft(){var t,n=Object(c.useState)([]),e=Object(a.a)(n,2),i=e[0],o=e[1],u=Object(c.useState)(""),s=Object(a.a)(u,2),j=s[0],b=s[1],d=Object(c.useState)("https://student-json-api.lidemy.me/posts?_page=1&_limit=5&_sort=createdAt&_order=desc"),l=Object(a.a)(d,2),f=l[0],O=l[1],x=Object(c.useState)([]),v=Object(a.a)(x,2),g=v[0],m=v[1];return Object(c.useEffect)((function(){p(f).then((function(t){m(t.links),o(t.posts)}))}),[f]),Object(c.useEffect)((function(){fetch("".concat(h,"/posts?_page=1&_limit=5&_sort=createdAt&_order=desc")).then((function(t){return t.headers.get("x-total-count")})).then((function(t){return b(t)}))}),[j]),t=4===g.length?Object(r.jsxs)("div",{children:[Object(r.jsx)(Bt,{onClick:function(){return O(g[0][0])},children:"\u7b2c\u4e00\u9801"}),Object(r.jsx)(Bt,{onClick:function(){return O(g[1][0])},children:"\u4e0a\u4e00\u9801"}),Object(r.jsx)(Bt,{onClick:function(){return O(g[2][0])},children:"\u4e0b\u4e00\u9801"}),Object(r.jsx)(Bt,{onClick:function(){return O(g[3][0])},children:"\u6700\u5f8c\u4e00\u9801"})]}):Object(r.jsxs)("div",{children:[Object(r.jsx)(Bt,{onClick:function(){return O(g[0][0])},children:"\u7b2c\u4e00\u9801"}),Object(r.jsx)(Bt,{onClick:function(){return O(g[1][0])},children:"\u4e0b\u4e00\u9801"}),Object(r.jsx)(Bt,{onClick:function(){return O(g[2][0])},children:"\u6700\u5f8c\u4e00\u9801"})]}),Object(r.jsxs)(Jt,{children:[Object(r.jsxs)(Mt,{children:["\u7e3d\u5171\u6709: ",j," \u7b46\u6587\u7ae0\u3002"]}),i.map((function(t){return Object(r.jsx)(qt,{post:t},t.id)})),t]})}function Gt(){var t=Object(u.a)(["\n  text-align: center;\n  margin-top: 5rem;\n"]);return Gt=function(){return t},t}function Ht(){var t=Object(u.a)(["\n  color: red;\n"]);return Ht=function(){return t},t}var Kt=s.a.div(Ht()),Qt=s.a.form(Gt());function Vt(){var t=Object(c.useContext)(v),n=t.setUser,e=t.setIsLoading,i=Object(c.useState)(""),o=Object(a.a)(i,2),u=o[0],s=o[1],j=Object(c.useState)(""),b=Object(a.a)(j,2),d=b[0],l=b[1],O=Object(c.useState)(""),p=Object(a.a)(O,2),m=p[0],w=p[1],y=Object(c.useState)(""),S=Object(a.a)(y,2),k=S[0],C=S[1],L=Object(g.f)();return Object(r.jsxs)(Qt,{onSubmit:function(t){t.preventDefault(),function(t,n,e){return fetch("".concat(h,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:t,username:n,password:e})}).then((function(t){return t.json()}))}(u,d,m).then((function(t){t.ok||C(t.message),f(t.token),x().then((function(t){t.ok&&(e(!1),n(t.data),L.push("/"))}))}))},children:[Object(r.jsxs)("div",{children:["nickname:"," ",Object(r.jsx)("input",{value:u,onChange:function(t){return s(t.target.value)}})]}),Object(r.jsxs)("div",{children:["username:"," ",Object(r.jsx)("input",{value:d,onChange:function(t){return l(t.target.value)}})]}),Object(r.jsxs)("div",{children:["password:"," ",Object(r.jsx)("input",{value:m,onChange:function(t){return w(t.target.value)},type:"password"})]}),Object(r.jsx)("button",{children:"\u767b\u5165"}),k&&Object(r.jsx)(Kt,{children:k})]})}function Wt(){var t=Object(u.a)(["\n  padding-top: 64px;\n"]);return Wt=function(){return t},t}var Xt=s.a.div(Wt());var Yt=function(){var t=Object(c.useState)(null),n=Object(a.a)(t,2),e=n[0],i=n[1],o=Object(c.useState)(!0),u=Object(a.a)(o,2),s=u[0],j=u[1];return Object(c.useEffect)((function(){O()?x().then((function(t){t.ok?(j(!1),i(t.data)):j(!1)})):j(!1)}),[]),Object(r.jsx)(v.Provider,{value:{user:e,setUser:i,isLoading:s,setIsLoading:j},children:Object(r.jsx)(Xt,{children:Object(r.jsxs)(C.a,{children:[Object(r.jsx)(K,{}),Object(r.jsxs)(g.c,{children:[Object(r.jsx)(g.a,{exact:!0,path:"/",children:Object(r.jsx)(R,{})}),Object(r.jsx)(g.a,{path:"/login",children:Object(r.jsx)(k,{})}),Object(r.jsx)(g.a,{path:"/register",children:Object(r.jsx)(Vt,{})}),Object(r.jsx)(g.a,{path:"/about",children:Object(r.jsx)(_t,{})}),Object(r.jsx)(g.a,{path:"/postsList",children:Object(r.jsx)(Ft,{})}),Object(r.jsx)(g.a,{path:"/new-post",children:Object(r.jsx)(yt,{})}),Object(r.jsx)(g.a,{path:"/posts/:id",children:Object(r.jsx)(xt,{})})]})]})})})},Zt=Object(Q.a)({reducer:{posts:et}});o.a.render(Object(r.jsx)(rt.a,{store:Zt,children:Object(r.jsx)(Yt,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.9e587af7.chunk.js.map