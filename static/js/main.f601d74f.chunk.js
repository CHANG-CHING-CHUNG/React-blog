(this["webpackJsonpreact-blog"]=this["webpackJsonpreact-blog"]||[]).push([[0],{38:function(t,n,e){"use strict";e.r(n);var r=e(1),c=e(0),i=e.n(c),a=e(21),o=e.n(a),u=e(4),s=e(2),j=e(3),b=e(17),d=e.n(b),l=e(22),f="token",O=function(t){localStorage.setItem(f,t)},h=function(){return localStorage.getItem(f)},x="https://student-json-api.lidemy.me",p=function(){var t=Object(l.a)(d.a.mark((function t(n){var e,r,c,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(n);case 2:return e=t.sent,r=e.headers,t.next=6,e.json();case 6:return c=t.sent,i=(i=r.get("link").replace(/\</gi,"").replace(/\>/gi,"").split(",")).map((function(t){return t.replace(/http/,"https").replace(/ /,"").split(";")})),t.abrupt("return",{links:i,posts:c});case 10:case"end":return t.stop()}}),t)})));return function(n){return t.apply(this,arguments)}}(),v=function(){var t=h();return fetch("".concat(x,"/me"),{headers:{authorization:"Bearer ".concat(t)}}).then((function(t){return t.json()}))},g=Object(c.createContext)(null),m=e(5);function S(){var t=Object(s.a)(["\n  text-align: center;\n  margin-top: 5rem;\n"]);return S=function(){return t},t}function y(){var t=Object(s.a)(["\n  color: red;\n"]);return y=function(){return t},t}var w=j.a.div(y()),k=j.a.form(S());function C(){var t=Object(c.useContext)(g).setUser,n=Object(c.useState)(""),e=Object(u.a)(n,2),i=e[0],a=e[1],o=Object(c.useState)(""),s=Object(u.a)(o,2),j=s[0],b=s[1],d=Object(c.useState)(""),l=Object(u.a)(d,2),f=l[0],h=l[1],p=Object(m.f)();return Object(r.jsxs)(k,{onSubmit:function(n){n.preventDefault(),h(null),function(t,n){return fetch("".concat(x,"/login"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:t,password:n})}).then((function(t){return t.json()}))}(i,j).then((function(n){if(0===n.ok)return h(n.message);O(n.token),v().then((function(n){if(1!==n.ok)return O(null),h(n.toString());t(n.data),p.push("/")}))}))},children:[Object(r.jsxs)("div",{children:["username:"," ",Object(r.jsx)("input",{value:i,onChange:function(t){return a(t.target.value)}})]}),Object(r.jsxs)("div",{children:["password:"," ",Object(r.jsx)("input",{value:j,onChange:function(t){return b(t.target.value)},type:"password"})]}),Object(r.jsx)("button",{children:"\u767b\u5165"}),f&&Object(r.jsx)(w,{children:f})]})}var L=e(9);function _(){var t=Object(s.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return _=function(){return t},t}function z(){var t=Object(s.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return z=function(){return t},t}function $(){var t=Object(s.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return $=function(){return t},t}function A(){var t=Object(s.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return A=function(){return t},t}var D=j.a.div(A()),E=j.a.div($()),I=Object(j.a)(L.b)(z()),J=j.a.div(_());function P(t){var n=t.post;return Object(r.jsxs)(E,{children:[Object(r.jsx)(I,{to:"/posts/".concat(n.id),children:n.title}),Object(r.jsx)(J,{children:new Date(n.createdAt).toLocaleString()})]})}function U(){var t=Object(c.useState)([]),n=Object(u.a)(t,2),e=n[0],i=n[1];return Object(c.useEffect)((function(){fetch("".concat(x,"/posts?_sort=createdAt&_order=desc")).then((function(t){return t.json()})).then((function(t){return i(t)}))}),[]),Object(r.jsx)(D,{children:e.map((function(t){return Object(r.jsx)(P,{post:t},t.id)}))})}function B(){var t=Object(s.a)(["\n  display: flex;\n  align-items: center;\n\n  "," {\n    margin-left: 64px;\n  }\n"]);return B=function(){return t},t}function N(){var t=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 100%;\n  box-sizing: border-box;\n  width: 100px;\n  cursor: pointer;\n  color: black;\n  text-decoration: none;\n  ","\n"]);return N=function(){return t},t}function T(){var t=Object(s.a)(["\n  display: flex;\n  align-items: center;\n  height: 64px;\n"]);return T=function(){return t},t}function M(){var t=Object(s.a)(["\n  font-size: 32px;\n  font-weight: bold;\n"]);return M=function(){return t},t}function R(){var t=Object(s.a)(["\n  height: 64px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.2);\n  padding: 0px 32px;\n  box-sizing: border-box;\n  background-color: #fff;\n"]);return R=function(){return t},t}var q=j.a.div(R()),F=j.a.div(M()),G=j.a.div(T()),H=Object(j.a)(L.b)(N(),(function(t){return t.$active&&"\n    background: rgba(0,0,0,0.1);\n  "})),K=j.a.div(B(),G);function Q(){var t=Object(m.g)(),n=Object(c.useContext)(g),e=n.user,i=n.setUser,a=n.isLoading,o=Object(m.f)();return Object(r.jsxs)(q,{children:[Object(r.jsxs)(K,{children:[Object(r.jsx)(F,{children:"\u90e8\u843d\u683c"}),Object(r.jsxs)(G,{children:[Object(r.jsx)(H,{to:"/",$active:"/"===t.pathname,children:"\u9996\u9801"}),Object(r.jsx)(H,{to:"/about",$active:"/about"===t.pathname,children:"\u95dc\u65bc\u90e8\u843d\u683c"}),Object(r.jsx)(H,{to:"/postsList",$active:"/postsList"===t.pathname,children:"\u6587\u7ae0\u5217\u8868"}),e&&Object(r.jsx)(H,{$active:"/new-post"===t.pathname,to:"/new-post",children:"\u767c\u5e03\u6587\u7ae0"})]})]}),a?null:Object(r.jsxs)(G,{children:[!e&&Object(r.jsx)(H,{$active:"/login"===t.pathname,to:"/login",children:"\u767b\u5165"}),!e&&Object(r.jsx)(H,{$active:"/register"===t.pathname,to:"/register",children:"\u8a3b\u518a"}),e&&Object(r.jsx)(H,{onClick:function(){O(""),i(null),"/"!==t.pathname&&o.push("/")},children:"\u767b\u51fa"})]})]})}function V(){var t=Object(s.a)(["\n  max-width: 600px;\n  width: 100%;\n  text-align: center;\n  padding: 10px;\n"]);return V=function(){return t},t}function W(){var t=Object(s.a)(["\n  display: flex;\n  justify-content: center;\n  max-width: 600px;\n  width: 100%;\n  flex-direction: column;\n  align-items: center;\n  padding: 10px;\n"]);return W=function(){return t},t}function X(){var t=Object(s.a)([""]);return X=function(){return t},t}function Y(){var t=Object(s.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return Y=function(){return t},t}function Z(){var t=Object(s.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n  margin-bottom: 10px;\n"]);return Z=function(){return t},t}function tt(){var t=Object(s.a)(["\n  border-bottom: px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n"]);return tt=function(){return t},t}function nt(){var t=Object(s.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return nt=function(){return t},t}var et=j.a.div(nt()),rt=j.a.div(tt()),ct=j.a.div(Z()),it=j.a.div(Y()),at=j.a.div(X()),ot=j.a.div(W()),ut=j.a.div(V());function st(){var t=Object(m.h)().id,n=Object(c.useState)([]),e=Object(u.a)(n,2),i=e[0],a=e[1];return Object(c.useEffect)((function(){(function(t){return fetch("".concat(x,"/posts/").concat(t)).then((function(t){return t.json()}))})(t).then((function(t){return a(t)}))}),[t]),Object(r.jsx)(et,{children:i.id?Object(r.jsxs)(rt,{children:[Object(r.jsxs)(ot,{children:[Object(r.jsx)(ct,{children:i.title}),Object(r.jsx)(it,{children:new Date(i.createdAt).toLocaleString()})]}),Object(r.jsx)(ut,{children:Object(r.jsx)(at,{children:i.body})})]}):null})}function jt(){var t=Object(s.a)(["\n  text-align: center;\n  margin-top: 5rem;\n"]);return jt=function(){return t},t}function bt(){var t=Object(s.a)(["\n  color: red;\n"]);return bt=function(){return t},t}var dt=j.a.div(bt()),lt=j.a.form(jt());function ft(){var t=Object(c.useState)(""),n=Object(u.a)(t,2),e=n[0],i=n[1],a=Object(c.useState)(""),o=Object(u.a)(a,2),s=o[0],j=o[1],b=Object(c.useState)(""),d=Object(u.a)(b,2),l=d[0],f=d[1],O=Object(m.f)();return Object(r.jsxs)(lt,{onSubmit:function(t){t.preventDefault(),function(t,n){var e=h();return fetch("".concat(x,"/posts"),{method:"POST",headers:{authorization:"Bearer ".concat(e),"content-type":"application/json"},body:JSON.stringify({title:t,body:n})}).then((function(t){return t.json()}))}(e,s).then((function(t){0===t.ok&&f(t.message),i(""),j(""),O.push("/")}))},children:[Object(r.jsxs)("div",{children:["title:",Object(r.jsx)("input",{value:e,onChange:function(t){return i(t.target.value)}})]}),Object(r.jsxs)("div",{children:["body:",Object(r.jsx)("textarea",{cols:"50",rows:"20",value:s,onChange:function(t){return j(t.target.value)}})]}),Object(r.jsx)("button",{children:"\u767c\u5e03"}),l&&Object(r.jsx)(dt,{children:l})]})}function Ot(){var t=Object(s.a)(["\n  max-width: 600px;\n  line-height: 1.5;\n"]);return Ot=function(){return t},t}function ht(){var t=Object(s.a)([""]);return ht=function(){return t},t}function xt(){var t=Object(s.a)(["\n  width: 80%;\n  display: flex;\n  margin: 0 auto;\n  align-items: center;\n  justify-content: center;\n  flex-direction: column;\n"]);return xt=function(){return t},t}var pt=j.a.div(xt()),vt=j.a.h1(ht()),gt=j.a.h3(Ot());function mt(){return Object(r.jsxs)(pt,{children:[Object(r.jsx)(vt,{children:"\u95dc\u65bc\u90e8\u843d\u683c\u7684\u4e8c\u4e09\u4e8b"}),Object(r.jsx)(gt,{children:"\u9019\u662f Mentor program \u7a0b\u5f0f\u5c0e\u5e2b\u8a08\u756b\u7b2c4\u671f\u7b2c22\u9031\u7684\u4f5c\u696d \u9019\u9031\u6211\u5011\u7528 React \u5c07\u8ab2\u7a0b\u88e1\u505a\u5230\u4e00\u534a\u7684\u90e8\u843d\u683c\u529f\u80fd\u88dc\u5b8c\u3002"})]})}function St(){var t=Object(s.a)([""]);return St=function(){return t},t}function yt(){var t=Object(s.a)(["\n  margin-top: 2rem;\n"]);return yt=function(){return t},t}function wt(){var t=Object(s.a)(["\n  color: rgba(0, 0, 0, 0.8);\n"]);return wt=function(){return t},t}function kt(){var t=Object(s.a)(["\n  font-size: 24px;\n  color: #333;\n  text-decoration: none;\n"]);return kt=function(){return t},t}function Ct(){var t=Object(s.a)(["\n  border-bottom: 1px solid rgba(0, 12, 34, 0.2);\n  padding: 16px;\n  display: flex;\n  align-items: flex-end;\n  justify-content: space-between;\n"]);return Ct=function(){return t},t}function Lt(){var t=Object(s.a)(["\n  width: 80%;\n  margin: 0 auto;\n"]);return Lt=function(){return t},t}var _t=j.a.div(Lt()),zt=j.a.div(Ct()),$t=Object(j.a)(L.b)(kt()),At=j.a.div(wt()),Dt=j.a.button(yt()),Et=j.a.h1(St());function It(t){var n=t.post;return Object(r.jsxs)(zt,{children:[Object(r.jsx)($t,{to:"/posts/".concat(n.id),children:n.title}),Object(r.jsx)(At,{children:new Date(n.createdAt).toLocaleString()})]})}function Jt(){var t,n=Object(c.useState)([]),e=Object(u.a)(n,2),i=e[0],a=e[1],o=Object(c.useState)(""),s=Object(u.a)(o,2),j=s[0],b=s[1],d=Object(c.useState)("https://student-json-api.lidemy.me/posts?_page=1&_limit=5&_sort=createdAt&_order=desc"),l=Object(u.a)(d,2),f=l[0],O=l[1],h=Object(c.useState)([]),v=Object(u.a)(h,2),g=v[0],m=v[1];return Object(c.useEffect)((function(){p(f).then((function(t){m(t.links),a(t.posts)}))}),[f]),Object(c.useEffect)((function(){fetch("".concat(x,"/posts?_page=1&_limit=5&_sort=createdAt&_order=desc")).then((function(t){return t.headers.get("x-total-count")})).then((function(t){return b(t)}))}),[j]),t=4===g.length?Object(r.jsxs)("div",{children:[Object(r.jsx)(Dt,{onClick:function(){return O(g[0][0])},children:"\u7b2c\u4e00\u9801"}),Object(r.jsx)(Dt,{onClick:function(){return O(g[1][0])},children:"\u4e0a\u4e00\u9801"}),Object(r.jsx)(Dt,{onClick:function(){return O(g[2][0])},children:"\u4e0b\u4e00\u9801"}),Object(r.jsx)(Dt,{onClick:function(){return O(g[3][0])},children:"\u6700\u5f8c\u4e00\u9801"})]}):Object(r.jsxs)("div",{children:[Object(r.jsx)(Dt,{onClick:function(){return O(g[0][0])},children:"\u7b2c\u4e00\u9801"}),Object(r.jsx)(Dt,{onClick:function(){return O(g[1][0])},children:"\u4e0b\u4e00\u9801"}),Object(r.jsx)(Dt,{onClick:function(){return O(g[2][0])},children:"\u6700\u5f8c\u4e00\u9801"})]}),Object(r.jsxs)(_t,{children:[Object(r.jsxs)(Et,{children:["\u7e3d\u5171\u6709: ",j," \u7b46\u6587\u7ae0\u3002"]}),i.map((function(t){return Object(r.jsx)(It,{post:t},t.id)})),t]})}function Pt(){var t=Object(s.a)(["\n  text-align: center;\n  margin-top: 5rem;\n"]);return Pt=function(){return t},t}function Ut(){var t=Object(s.a)(["\n  color: red;\n"]);return Ut=function(){return t},t}var Bt=j.a.div(Ut()),Nt=j.a.form(Pt());function Tt(){var t=Object(c.useContext)(g),n=t.setUser,e=t.setIsLoading,i=Object(c.useState)(""),a=Object(u.a)(i,2),o=a[0],s=a[1],j=Object(c.useState)(""),b=Object(u.a)(j,2),d=b[0],l=b[1],f=Object(c.useState)(""),h=Object(u.a)(f,2),p=h[0],S=h[1],y=Object(c.useState)(""),w=Object(u.a)(y,2),k=w[0],C=w[1],L=Object(m.f)();return Object(r.jsxs)(Nt,{onSubmit:function(t){t.preventDefault(),function(t,n,e){return fetch("".concat(x,"/register"),{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({nickname:t,username:n,password:e})}).then((function(t){return t.json()}))}(o,d,p).then((function(t){t.ok||C(t.message),O(t.token),v().then((function(t){t.ok&&(e(!1),n(t.data),L.push("/"))}))}))},children:[Object(r.jsxs)("div",{children:["nickname:"," ",Object(r.jsx)("input",{value:o,onChange:function(t){return s(t.target.value)}})]}),Object(r.jsxs)("div",{children:["username:"," ",Object(r.jsx)("input",{value:d,onChange:function(t){return l(t.target.value)}})]}),Object(r.jsxs)("div",{children:["password:"," ",Object(r.jsx)("input",{value:p,onChange:function(t){return S(t.target.value)},type:"password"})]}),Object(r.jsx)("button",{children:"\u767b\u5165"}),k&&Object(r.jsx)(Bt,{children:k})]})}function Mt(){var t=Object(s.a)(["\n  padding-top: 64px;\n"]);return Mt=function(){return t},t}var Rt=j.a.div(Mt());var qt=function(){var t=Object(c.useState)(null),n=Object(u.a)(t,2),e=n[0],i=n[1],a=Object(c.useState)(!0),o=Object(u.a)(a,2),s=o[0],j=o[1];return Object(c.useEffect)((function(){h()?v().then((function(t){t.ok?(j(!1),i(t.data)):j(!1)})):j(!1)}),[]),Object(r.jsx)(g.Provider,{value:{user:e,setUser:i,isLoading:s,setIsLoading:j},children:Object(r.jsx)(Rt,{children:Object(r.jsxs)(L.a,{children:[Object(r.jsx)(Q,{}),Object(r.jsxs)(m.c,{children:[Object(r.jsx)(m.a,{exact:!0,path:"/",children:Object(r.jsx)(U,{})}),Object(r.jsx)(m.a,{path:"/login",children:Object(r.jsx)(C,{})}),Object(r.jsx)(m.a,{path:"/register",children:Object(r.jsx)(Tt,{})}),Object(r.jsx)(m.a,{path:"/about",children:Object(r.jsx)(mt,{})}),Object(r.jsx)(m.a,{path:"/postsList",children:Object(r.jsx)(Jt,{})}),Object(r.jsx)(m.a,{path:"/new-post",children:Object(r.jsx)(ft,{})}),Object(r.jsx)(m.a,{path:"/posts/:id",children:Object(r.jsx)(st,{})})]})]})})})};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(qt,{})}),document.getElementById("root"))}},[[38,1,2]]]);
//# sourceMappingURL=main.f601d74f.chunk.js.map